# HKEx Annual Report Downloader

This repository contains two Python scripts for scraping and downloading the annual reports of Hong Kong-listed companies from the HKEx News. You will need to provide a text file containing the stock codes of the companies you wish to scrape and download reports for.

## Script Overview

### 1. scraper.py
The `scraper.py` script scrapes the URLs for annual reports from the HKEx News for the given stock codes (provided in a `Code.txt` file). It collects all available annual report URLs within a specified date range, starting from 2015.

#### Customizing the Date Range
You can customize the date range by modifying the following section of the `scraper.py` script:

```python
form_data = {
    "lang": "EN",
    "category": "0",
    "market": "SEHK",
    "searchType": "1",
    "documentType": "-1",
    "t1code": "40000",
    "t2Gcode": "-2",
    "t2code": "40100",
    "stockId": stock_id.strip(),
    "from": "20150101",  # Change start date here (format: YYYYMMDD)
    "to": "20250319",    # Change end date here (format: YYYYMMDD)
    "MB-Daterange": "0"
}
```
- The `"from"` field defines the start date of the range (in `YYYYMMDD` format).

- The `"to"` field defines the end date of the range (in `YYYYMMDD` format).

Modify these values to adjust the date range as per your requirements.

### 2. downloader.py
The `downloader.py` script downloads the annual reports from the URLs scraped by `scraper.py`. It downloads non-HTML files such as PDFs, DOCs, etc., and saves them in a local directory.

## Requirements

To run these scripts, you need to install the following Python libraries:
- `requests`
- `pandas`
- `selenium`
- `beautifulsoup4`
- `openpyxl`
- `concurrent.futures`

You can install the necessary libraries using pip:

```bash
pip install requests pandas selenium beautifulsoup4 openpyxl
```

## How to Use
### 1. Prepare the Stock Codes

- In `Code.txt`, list the stock codes of the companies you want to scrape and download reports for, one stock code per line.

### 2. Run the Scraper Script

- Execute the `scraper.py` script to scrape the URLs of the annual reports.

- The script will save the URLs to an Excel file called Annual_Reports.xlsx.

``` bash
python scraper.py
```
### 3. Run the Downloader Script

- After running the scraper, execute the `downloader.py` script to download the reports.

- The script will download the reports and save them in a folder named `Annual_Reports`.

``` bash
python downloader.py
```

## Example
For demonstration purposes, an example folder `Annual_Reports_Example/` and an example Excel file `Annual_Reports_Example.xlsx` have been included. These files contain a sample set of URLs and reports for reference.

## File Structure

``` bash
├── scraper.py                # Script to scrape annual report URLs
├── downloader.py             # Script to download the reports
├── Code.txt                  # Text file containing stock codes
├── Annual_Reports_Example/   # Directory containing example downloaded reports
├── Annual_Reports_Example.xlsx  # Example Excel file with sample URLs
└── Annual_Reports/           # (Generated by the script) Directory to save downloaded reports
└── Annual_Reports.xlsx       # (Generated by the script) Excel file with URLs scraped by scraper.py
```

## Notes
The `scraper.py` script uses Selenium to navigate the HKEx News, so you will need to have a compatible web driver (such as ChromeDriver) installed.
